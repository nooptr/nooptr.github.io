<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2a307e351b108d9d5ca1.css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:26px;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-flex:0;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:-webkit-box;display:flex;align-content:center;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;height:35px;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:-webkit-box;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#5d93ff}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:-webkit-gradient(linear,left top,left bottom,from(#e6e6e6),color-stop(48%,#e6e6e6),to(#fff));background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:540px;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:-webkit-box;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:35px;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#5d93ff}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:35px;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.17.10"/><link rel="alternate" type="application/rss+xml" title="Nghệ Thuật Coding" href="/rss.xml"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-139428410-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-139428410-1', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=2a878cc1f2bb435fca15661e8ed624b8"/><title data-react-helmet="true">Hệ thống Viblo Code Challenge được xây dựng như thế nào - Nghệ Thuật Coding</title><meta data-react-helmet="true" name="description" content="Chia sẻ những kinh nghiệm, kiến thức, các case study giúp mọi người có thể tạo ra những service chuyên nghiệp hơn"/><meta data-react-helmet="true" property="og:site_name" content="Hệ thống Viblo Code Challenge được xây dựng như thế nào - Nghệ Thuật Coding"/><meta data-react-helmet="true" property="og:image" content="https://nghethuatcoding.com/media/nghethuatcoding_avatar.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Hệ thống Viblo Code Challenge được xây dựng như thế nào - Nghệ Thuật Coding"/><meta data-react-helmet="true" name="twitter:description" content="Chia sẻ những kinh nghiệm, kiến thức, các case study giúp mọi người có thể tạo ra những service chuyên nghiệp hơn"/><meta data-react-helmet="true" name="twitter:image" content="https://nghethuatcoding.com/media/nghethuatcoding_avatar.png"/><link as="script" rel="preload" href="/webpack-runtime-97292a8bc13656196dce.js"/><link as="script" rel="preload" href="/app-b43aa91d7aaf581e9335.js"/><link as="script" rel="preload" href="/styles-c54d467e3152b7dbde15.js"/><link as="script" rel="preload" href="/commons-ef2cf60bd8fdb439a93c.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-170042985fc317eb7bf0.js"/><link as="fetch" rel="preload" href="/page-data/2019/06/05/viblo-code-challenge-duoc-xay-dung-nhu-the-nao/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Hệ thống Viblo Code Challenge được xây dựng như thế nào</h1><div class="Content-module--content__body--2TrQ-"><p>Chắc hẳn ai trong số chúng ta cũng đã từng tham gia 1 số cuộc thi về contest hay là code challenge. Ví dụ như <a href="https://vn.talenthub.jp/coding_test" target="_blank" rel="nofollow noopener noreferrer">TalenHub</a>, <a href="https://code.viblo.asia/dashboard" target="_blank" rel="nofollow noopener noreferrer">Viblo Code</a>, <a href="https://www.topcoder.com/" target="_blank" rel="nofollow noopener noreferrer">Top Coder</a> …</p>
<p>Nhưng ít ai để ý đến xem những service đó được làm như thế nào? Làm thế nào có thể run được đoạn code mà mình đã submit? </p>
<p>Hôm nay mình sẽ đi đào sâu vào những hệ thống đó xem cụ thể nó được xây dựng như thế nào, và kiến trúc của nó ra sao. Đặc biệt để dễ hình dung thì mình sẽ đi lấy ví dụ về Viblo Code nhé.</p>
<p>Mình không phải là nhân viên của Framgia nên có thể hệ thống Viblo Code sẽ khác so với cái mà mình đã phỏng đoán. Nhưng mình nghĩ cơ chế nó sẽ giống nhau.</p>
<p><strong>Mục đích bài viết:</strong></p>
<ul>
<li>Hiểu được các hệ thống về Code challenge làm việc như thế nào</li>
<li>Tự mình có thể xây dựng được 1 hệ thống như thế</li>
</ul>
<p><strong>Đối tượng hướng đến:</strong></p>
<ul>
<li>Người thích làm về mảng về hệ thống</li>
<li>Người có kinh nghiệm về Docker</li>
</ul>
<h2 id="hệ-thống-code-challenge-là-gì"><a href="#h%E1%BB%87-th%E1%BB%91ng-code-challenge-l%C3%A0-g%C3%AC" aria-label="hệ thống code challenge là gì permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hệ thống Code Challenge là gì?</h2>
<p>Code Challenge là dịch vụ dành cho lập trình viên rèn luyện kĩ năng về lập trình, cũng như các tư duy về giải thuật. </p>
<ul>
<li><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/89d8f641f6975bdd74be9bbebed67c46/72b76/viblo-code-dashboard.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62.94859359844811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABUElEQVQoz5WSi27CIBiFef8X3GyphVKtdr2A3Mq1+6vb4rLNzJMvhAQOJxxAhDLK2po2tGmFlNouXIpevE1GHvsJ0yNlh34Yx5lLpWFVm8XYDaUNKsqyqvZAUWKlVF5Xxbnhl3XNV27Kn+M30G5X1ISCeVeU8zzHnCQEKJVSzDk9BuGqAkqMwTzN/NeEv0CMtZQ2TcMIoZyL58znTT3QdZ3W5jkzgZbbA9x2GAbv/f+dm7nrTuM4Qc9CCGvt43rv2IRKXBUgjF9ed6fTOaYcIvScQ/ApQaWbviagNecYo12c8x7VhOxrAoXVNRmGcZhEczhLqayxcTsFNq9X73oDFGK6fRXUMBYChEUYIeEiZXfquZA+pAeECPkZYVyxtoXHIpQqrYx1s9DWRWWcMl7ZK/eTDxxsQvC3oDBgmmaozfmgrTdLMIs39geLty7cWFx4B3qE7cAObodHAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/89d8f641f6975bdd74be9bbebed67c46/01472/viblo-code-dashboard.webp 240w,
/static/89d8f641f6975bdd74be9bbebed67c46/222bd/viblo-code-dashboard.webp 480w,
/static/89d8f641f6975bdd74be9bbebed67c46/620b9/viblo-code-dashboard.webp 960w,
/static/89d8f641f6975bdd74be9bbebed67c46/2a520/viblo-code-dashboard.webp 1031w"
          sizes="(max-width: 960px) 100vw, 960px"
          type="image/webp"
        />
        <source
          srcset="/static/89d8f641f6975bdd74be9bbebed67c46/0783d/viblo-code-dashboard.png 240w,
/static/89d8f641f6975bdd74be9bbebed67c46/782f4/viblo-code-dashboard.png 480w,
/static/89d8f641f6975bdd74be9bbebed67c46/f570d/viblo-code-dashboard.png 960w,
/static/89d8f641f6975bdd74be9bbebed67c46/72b76/viblo-code-dashboard.png 1031w"
          sizes="(max-width: 960px) 100vw, 960px"
          type="image/png"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/89d8f641f6975bdd74be9bbebed67c46/f570d/viblo-code-dashboard.png"
          alt="viblo code dashboard"
          title="viblo code dashboard"
          loading="lazy"
        />
      </picture>
  </a>
    </span></li>
</ul>
<p>Như hình ảnh bên trên về Viblo Code chúng ta có thể thấy, nó bao gồm phần câu hỏi, phần viết code, phần chọn ngôn ngữ mà mình thích …</p>
<p>Ngoài ra còn có 1 số chức năng khác nữa như Ranking (code của ai chạy nhanh sẽ được xếp hạng cao hơn …), nhận thưởng nếu đứng top.</p>
<h2 id="yêu-cầu-về-mặt-chức-năng"><a href="#y%C3%AAu-c%E1%BA%A7u-v%E1%BB%81-m%E1%BA%B7t-ch%E1%BB%A9c-n%C4%83ng" aria-label="yêu cầu về mặt chức năng permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Yêu cầu về mặt chức năng</h2>
<ul>
<li>Với mỗi câu hỏi có thể chọn ngôn ngữ lập trình (shell, php, javascript, java …) mình muốn làm.</li>
<li>Khi submit code trả về kết quả, kèm theo thời gian thực thi</li>
<li>Có giới hạn về thời gian làm bài (ví dụ như chỉ làm trong 15p chẳng hạn) </li>
<li>Xếp hạng điểm của người dùng</li>
</ul>
<p>Hôm nay mình sẽ tập trung chủ yếu vào phần thực thi code ứng với từng language (java, php, javascript …) . Còn phần ranking mình sẽ không đề cập đến ở đây.</p>
<h2 id="kiến-trúc-hệ-thống"><a href="#ki%E1%BA%BFn-tr%C3%BAc-h%E1%BB%87-th%E1%BB%91ng" aria-label="kiến trúc hệ thống permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kiến trúc hệ thống</h2>
<p>Mình nghĩ đầu tiên ai cũng sẽ đưa ra kiến trúc kiểu như này. Cùng xem xem nó có ổn không nhé.</p>
<ul>
<li><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 604px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9f190cb5f707f021dbdd1b09bc37de0e/5e702/code-challenge-architecture-1.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.90066225165563%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe5NiWo//8QAGRABAAMBAQAAAAAAAAAAAAAAAQACMREh/9oACAEBAAEFAnrPQGWyuT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAICFR/9oACAEBAAY/Aoav/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMRAh/9oACAEBAAE/IV0Q3WhrWCXUPHH/2gAMAwEAAgADAAAAEHMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAMAAwEAAAAAAAAAAAAAAQARIRBRcZH/2gAIAQEAAT8QrLWP2aksCnZbmr5EULM2BEW3vj//2Q=='); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/9f190cb5f707f021dbdd1b09bc37de0e/01472/code-challenge-architecture-1.webp 240w,
/static/9f190cb5f707f021dbdd1b09bc37de0e/222bd/code-challenge-architecture-1.webp 480w,
/static/9f190cb5f707f021dbdd1b09bc37de0e/3a1dc/code-challenge-architecture-1.webp 604w"
          sizes="(max-width: 604px) 100vw, 604px"
          type="image/webp"
        />
        <source
          srcset="/static/9f190cb5f707f021dbdd1b09bc37de0e/3bc27/code-challenge-architecture-1.jpg 240w,
/static/9f190cb5f707f021dbdd1b09bc37de0e/98431/code-challenge-architecture-1.jpg 480w,
/static/9f190cb5f707f021dbdd1b09bc37de0e/5e702/code-challenge-architecture-1.jpg 604w"
          sizes="(max-width: 604px) 100vw, 604px"
          type="image/jpeg"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/9f190cb5f707f021dbdd1b09bc37de0e/5e702/code-challenge-architecture-1.jpg"
          alt="code challenge architecture 1"
          title="code challenge architecture 1"
          loading="lazy"
        />
      </picture>
  </a>
    </span></li>
</ul>
<p>Chúng ta có 1 con web server, và ở trong con web server này sẽ cài tất cả các package liên quan đến tất cả các ngôn ngữ để có thể chạy được. Ví dụ như sẽ cài php, nodejs, java, python … tất tần tật lên con web server này.</p>
<p>Và khi người dùng submit code của mình lên để test thì khi đó con web server này sẽ nhận request từ người dùng (giả sử như request này dạng json) bao gồm phần content và language. </p>
<p>Nó sẽ lưu cái phần content này vào 1 file. ví dụ như với ngôn ngữ php  thì sẽ lưu file dạng main.php, nếu ngôn ngữ javascript thì sẽ lưu dạng main.js.</p>
<p>Và để xem đoạn code này có chạy được hay không thì web server sẽ chạy 1 đoạn code kiểu như này.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;START=$(date +%s.%4N)

php main.php &gt; result.txt

END=$(date +%s.%4N)

runtime=$(echo &quot;$END - $START&quot; | bc)&lt;/code&gt;</code></pre></div>
<p>Khi đó nó sẽ trả về cho mình output của đoạn code và thời gian runtime cho người dùng. Với trường hợp là javascript hay python … thì cũng làm theo cách tương tự.</p>
<p>Vậy kiến trúc này có ổn không? Theo mình thì là không nhé. Có mấy lí do như sau:</p>
<ul>
<li>Vì web server này chạy trực tiếp shell lên server của mình nên nếu như người dùng gửi 1 đoạn code kiểu như: rm -rf /var/www/html/* thì chắc ăn hành to rồi.</li>
<li>Vì cài nhiều package lên con web quá như thế cũng là nguyên nhân gây ra 1 số rủi ro về vấn đề bảo mật. </li>
</ul>
<p>Để giải quyết bài toán trên thì chúng ta chỉ cần áp dụng docker vào là ok.</p>
<p>Cụ thể dưới đây là kiến trúc mình muốn đưa ra:</p>
<ul>
<li><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 926px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0835c907d16006307dc1bc52f766669f/d5d6f/code-challenge-architecture-2-2.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.50755939524837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3KOVEgH/xAAZEAACAwEAAAAAAAAAAAAAAAADMgABAjH/2gAIAQEAAQUCvu0GkKg0/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAh/9oACAEDAQE/ARyDL//EABYRAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAgEBPwFYXDS7/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQMUGBwf/aAAgBAQAGPwKx8M7lH//EAB0QAAICAQUAAAAAAAAAAAAAAAARASEQMVFhobH/2gAIAQEAAT8hbb4Hsfs0qh2FDZJTWN//2gAMAwEAAgADAAAAEEAP/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAGBkf/aAAgBAwEBPxDUik//xAAXEQEBAQEAAAAAAAAAAAAAAAARAAFB/9oACAECAQE/EHtchgN//8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBcVFhgf/aAAgBAQABPxAIFk6EZ9HRksz6xt5RQIFNNRkpGzXc2eUVvuf/2Q=='); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/0835c907d16006307dc1bc52f766669f/01472/code-challenge-architecture-2-2.webp 240w,
/static/0835c907d16006307dc1bc52f766669f/222bd/code-challenge-architecture-2-2.webp 480w,
/static/0835c907d16006307dc1bc52f766669f/21a8e/code-challenge-architecture-2-2.webp 926w"
          sizes="(max-width: 926px) 100vw, 926px"
          type="image/webp"
        />
        <source
          srcset="/static/0835c907d16006307dc1bc52f766669f/3bc27/code-challenge-architecture-2-2.jpg 240w,
/static/0835c907d16006307dc1bc52f766669f/98431/code-challenge-architecture-2-2.jpg 480w,
/static/0835c907d16006307dc1bc52f766669f/d5d6f/code-challenge-architecture-2-2.jpg 926w"
          sizes="(max-width: 926px) 100vw, 926px"
          type="image/jpeg"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/0835c907d16006307dc1bc52f766669f/d5d6f/code-challenge-architecture-2-2.jpg"
          alt="code challenge architecture 2 2"
          title="code challenge architecture 2 2"
          loading="lazy"
        />
      </picture>
  </a>
    </span></li>
</ul>
<p>Đầu tiên Web Server nhận request và khởi chạy container tương ứng với language được gửi lên. Sau đó run code thông qua container đó và nhận kết quả trả về cho người dùng.</p>
<p>Vậy chúng ta đã quyết định được kiến trúc hệ thống hợp lý. Tiếp theo sẽ đi vào phần lập trình.</p>
<h2 id="thiết-kế-api"><a href="#thi%E1%BA%BFt-k%E1%BA%BF-api" aria-label="thiết kế api permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Thiết kế API</h2>
<p>Về API thì mình nghĩ chỉ cần 1 cái API về submit code. Thông số đầu vào là content và language. Output sẽ trả về kết quả sau khi compile đoạn code của người dùng cùng với thời gian thực thi đoạn code.</p>
<ul>
<li><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 569px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7f7aeb796675e73baccec32bd5db5c51/9b80a/viblo-code-api.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.669595782073806%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABOUlEQVQoz4VRi46DIBD0U1qruICgCAj4TtP7/1+6Ua/mLrmkyYTsLjtkZsis08/n3DRC1qxpRWsk8UdF+QWin/ac47yQ+WBeryWFbhr619eKWjccDwlZ1qoCuCzRohBH8YeM3vdtTLYPZl5iGizaZY2hN9McMAnBDKMfRx+ONexz8SZ3Vi3rMM1xGPs0+pLlrHqD8pLdUUDtOTn0P86dnQyTMTbb2saonZMpCmvJOopBdB1NY+09dV3lHE9Ras2cpSHJ3nMpiwxOiN+JbsRz6FGaYSprGC6FLJSCz0IcE4CLArfYwS2WM6QNzes2QX/Jboe8+wkoZIfOiq78r/rwjGxDUMvcOgfB0loDeG86o/mvYP9FhrdD4M9NOy+mpEy7/1Nd42PYZ7LSvGkrRAJLyAYO91T5DvpE/gbJB2bijK9r/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/7f7aeb796675e73baccec32bd5db5c51/01472/viblo-code-api.webp 240w,
/static/7f7aeb796675e73baccec32bd5db5c51/222bd/viblo-code-api.webp 480w,
/static/7f7aeb796675e73baccec32bd5db5c51/c9eb1/viblo-code-api.webp 569w"
          sizes="(max-width: 569px) 100vw, 569px"
          type="image/webp"
        />
        <source
          srcset="/static/7f7aeb796675e73baccec32bd5db5c51/0783d/viblo-code-api.png 240w,
/static/7f7aeb796675e73baccec32bd5db5c51/782f4/viblo-code-api.png 480w,
/static/7f7aeb796675e73baccec32bd5db5c51/9b80a/viblo-code-api.png 569w"
          sizes="(max-width: 569px) 100vw, 569px"
          type="image/png"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/7f7aeb796675e73baccec32bd5db5c51/9b80a/viblo-code-api.png"
          alt="viblo code api"
          title="viblo code api"
          loading="lazy"
        />
      </picture>
  </a>
    </span></li>
</ul>
<h2 id="demo"><a href="#demo" aria-label="demo permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Demo</h2>
<p>Để dễ hiểu thì mình sẽ làm 1 phần demo để các bạn dễ hình dung.</p>
<p>Đây là kết quả sau khi gọi API để submit code.</p>
<ul>
<li><img src="/3f97fdc61199cc5f53fe69ab9fcff103/code-challenge-demo-3.gif"></li>
</ul>
<p>Còn đây là màn hình mô phỏng docker container làm việc (các bạn để ý cái màn hình terminal đằng sau đấy nhé). Cứ mỗi lần 1 request được gửi lên thì 1 container được khởi chạy và thực thi code. Nhìn khá là thú vị.</p>
<ul>
<li><img src="/912a1d136107269814582f529fd2cc4b/code-challenge-demo-4.gif"></li>
</ul>
<p>OK vậy các bạn cũng hiểu hiểu rõ cái API làm việc thế nào rồi đúng không. Bây giờ đi vào phần code nhé.</p>
<p>Về API mình sẽ code bằng Nodejs</p>
<p>Source code: <a href="https://github.com/nooptr/code-challenge" target="_blank" rel="nofollow noopener noreferrer">https://github.com/nooptr/code-challenge</a></p>
<ul>
<li><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 533px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/51798c582c25eafba2ccc25105c767ff/841f8/source-code.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 76.36022514071294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+0lEQVQoz5VS246DIBDl/z9t081ablKrUhVExev2B/Z026TtU8eEwCRwOJcZVrtW6tRkuQ+9C/0wznFaPq5xXvGedcOoTabS07mw2EMfcUHBV41jeAocyPHTsl0psDuza7sbuHb+KNSRy8JWe8CBoYLPS+1gW6jU+UCR/QDjCF1EYlleIjyi5yfzzX3tlDZcKOCnZYufMn8DA5NwmRe2j9MOzzhKW5nTmUsttUHm5FZ5BpEwnHCRlxf0nM7c+H/me84Ao6ZP2EO2rRqhNPbl9zqt2760IRWeMaToNuYE4ncwt92gUvN1+Ebg4KfYfmEeRjD/JBzkcV7psv8ABuI0jG7p7i0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/51798c582c25eafba2ccc25105c767ff/01472/source-code.webp 240w,
/static/51798c582c25eafba2ccc25105c767ff/222bd/source-code.webp 480w,
/static/51798c582c25eafba2ccc25105c767ff/ae920/source-code.webp 533w"
          sizes="(max-width: 533px) 100vw, 533px"
          type="image/webp"
        />
        <source
          srcset="/static/51798c582c25eafba2ccc25105c767ff/0783d/source-code.png 240w,
/static/51798c582c25eafba2ccc25105c767ff/782f4/source-code.png 480w,
/static/51798c582c25eafba2ccc25105c767ff/841f8/source-code.png 533w"
          sizes="(max-width: 533px) 100vw, 533px"
          type="image/png"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/51798c582c25eafba2ccc25105c767ff/841f8/source-code.png"
          alt="source code"
          title="source code"
          loading="lazy"
        />
      </picture>
  </a>
    </span></li>
</ul>
<p>Về image để build cho từng language mình để ở trong thư mục docker.</p>
<p>Ví dụ như với ngôn ngữ php thì nội dung của Dockerfile sẽ như sau:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;FROM php:7.3.6-cli-alpine3.9

RUN apk add --no-cache bc
RUN apk add --update coreutils &amp;&amp; rm -rf /var/cache/apk/*

WORKDIR /home/ntcd/

ADD script.sh /bin/script.sh
RUN chmod +x /bin/script.sh

ENTRYPOINT [&quot;sh&quot;, &quot;/bin/script.sh&quot;]&lt;/code&gt;</code></pre></div>
<p>Trong đó nội dung của file script.sh sẽ như sau:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;#!/bin/bash

# Sample execution command: ./script.sh php main.php

compiler=$1
file=$2
output=$3

START=$(date +%s.%4N)

$compiler $file &gt; $output

END=$(date +%s.%4N)

runtime=$(echo &quot;$END - $START&quot; | bc)

echo $runtime
&lt;/code&gt;</code></pre></div>
<p>Mục đích của file script.sh này là để thực thi compiler file code. Kết quả sau khi compiler sẽ được ghi vào file $output. Và thời gian thực thi sẽ được in ra màn hình.</p>
<p>Để web server có thể chạy được container thì cần phải cài đặt trước bằng lệnh:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;# PHP
docker build -t ntcd_php -f php/Dockerfile .

# Javascript
docker build -t ntcd_javascript -f javascript/Dockerfile .&lt;/code&gt;</code></pre></div>
<p>Tiếp theo cùng đi xem API viết như nào nhé:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;var express = require(&#39;express&#39;);
var router = express.Router();
var exec = require(&#39;child_process&#39;).exec;
var fs = require(&quot;fs-extra&quot;);
var crypto = require(&#39;crypto&#39;);

router.post(&#39;/run/:language&#39;, function(req, res, next) {
    var content = req.body.content;

    var folder = &quot;/tmp/&quot; + crypto.randomBytes(16).toString(&#39;hex&#39;);
    fs.mkdirSync(`${folder}`);

    if (req.params.language == &quot;php&quot;) {
        var inputFile = `${folder}/main.php`;
        fs.writeFileSync(inputFile, content);
        var command = `docker run --rm -v ${folder}:${folder} ntcd_php php ${inputFile} ${folder}/output`;
    } else if (req.params.language == &quot;javascript&quot;) {
        var inputFile = `${folder}/main.js`;
        fs.writeFileSync(inputFile, content);
        var command = `docker run --rm -v ${folder}:${folder} ntcd_javascript node ${inputFile} ${folder}/output`;
    }

    if (command == null) {
        res.json({
            stdout: &quot;&quot;,
            error: &quot;language not support&quot;,
        });
    }

    exec(command,
        (error, exec_time, stderr) =&gt; {
            var stdout = fs.readFileSync(`${folder}/output`, &#39;utf8&#39;);
            res.json({
                stdout: stdout,
                error: stderr,
                time: exec_time
            });

            fs.remove(folder, (err) =&gt; {});
        });
});

module.exports = router;
&lt;/code&gt;</code></pre></div>
<p>Nếu ai code nodejs rồi thì mình nghĩ đọc phát có thể hiểu được ngay.</p>
<p>Ban đầu nó sẽ nhận request từ người dùng. Dạng như sau:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;{
  &quot;content&quot;: &quot;&lt;?php $a = 12; $b = $a * 2; echo $b;&quot;
}&lt;/code&gt;</code></pre></div>
<p>Nó sẽ đọc content và ghi vào 1 file gọi là main.php (cái này tuỳ vào ngôn ngữ được gửi lên. Nếu là php thì ghi vào file main.php. Nếu là javascript thì ghi vào file main.js).</p>
<p>Sau đó, web server sẽ gọi docker container để thực thi code bằng lệnh:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;docker run -it --rm -v /tmp:/tmp ntcd_php php /tmp/main.php /tmp/output&lt;/code&gt;</code></pre></div>
<p>Cuối cùng sẽ đọc kết quả từ file /tmp/output và trả về cho người dùng với format response như sau:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;code&gt;{
  &quot;stdout&quot;: &quot;24&quot;,
  &quot;error&quot;: &quot;&quot;,
  &quot;time&quot;: &quot;.0911\n&quot;
}&lt;/code&gt;</code></pre></div>
<h2 id="kết-luận"><a href="#k%E1%BA%BFt-lu%E1%BA%ADn" aria-label="kết luận permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kết luận</h2>
<p>Các bạn thấy thế nào? Có đơn giản không ak? Chỉ với 1 đoạn code ngắn mà chúng ta có thể dễ dàng viết được  1 chương trình code challenge rồi.</p>
<p>Source code này mình chỉ viết dưới dạng demo thôi nên có thể có nhiều chỗ code chưa hợp lí. Các bạn tự sửa theo ý mình nhé.</p>
<p>==============</p>
<p>Để nhận thông báo khi có bài viết mới nhất thì các bạn có thể like fanpage của mình ở bên dưới nhé:</p>
<p>→→→ <a href="https://www.facebook.com/669339543503374" target="_blank" rel="nofollow noopener noreferrer">Nghệ thuật Coding Fanpage Facebook</a></p>
<p>Chúc các bạn 1 tuần thật vui vẻ.</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->5 Jun 2019</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/code-challenge/">code challenge</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/docker/">docker</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/viblo-code/">viblo code</a></li></ul></div><div class="Author-module--author--2Yefr"><p>Chia sẻ những kinh nghiệm, kiến thức, các case study giúp mọi người có thể tạo ra những service chuyên nghiệp hơn<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/undefined" rel="noopener noreferrer" target="_blank"><strong>Nghệ Thuật Coding</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2019/06/05/viblo-code-challenge-duoc-xay-dung-nhu-the-nao/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-b43aa91d7aaf581e9335.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-a7388efdc62430243a75.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-2d78b95820488a80d4f6.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-478e7cf397bee6a3869c.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-687635268273eb6cc827.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-fe888cf97aae0e68f5a0.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-170042985fc317eb7bf0.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-3bb6bfea6a321e68711c.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-d64a87cfe0726bc0363e.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-dfe2657256a613a3d39d.js"]};/*]]>*/</script><script src="/component---src-templates-post-template-js-170042985fc317eb7bf0.js" async=""></script><script src="/commons-ef2cf60bd8fdb439a93c.js" async=""></script><script src="/styles-c54d467e3152b7dbde15.js" async=""></script><script src="/app-b43aa91d7aaf581e9335.js" async=""></script><script src="/webpack-runtime-97292a8bc13656196dce.js" async=""></script></body></html>